<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>What the Package Does (Title Case) â€¢ templateB3</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/PT_Sans-0.4.9/font.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="What the Package Does (Title Case)">
<meta name="description" content="More about what it does (maybe more than one line) Use four spaces when indenting paragraphs within the Description.">
<meta property="og:description" content="More about what it does (maybe more than one line) Use four spaces when indenting paragraphs within the Description.">
<meta property="og:image" content="https://macsands.github.io/templateB3/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">templateB3</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/getting-started.html">getting-started</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://b-cubed.eu/" aria-label="B-Cubed website"><span class="fa fa-cube"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/macSands/templateB3/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="templateb3">templateB3<a class="anchor" aria-label="anchor" href="#templateb3"></a>
</h1>
</div>
<!-- badges: start -->

</div>
<div class="section level1">
<h1 id="dissmapr-a-novel-framework-for-automated-compositional-dissimilarity-and-biodiversity-turnover-analysis">dissMapR: A Novel Framework for Automated Compositional Dissimilarity and Biodiversity Turnover Analysis<a class="anchor" aria-label="anchor" href="#dissmapr-a-novel-framework-for-automated-compositional-dissimilarity-and-biodiversity-turnover-analysis"></a>
</h1>
<div class="section level2">
<h2 id="tutorial">Tutorial<a class="anchor" aria-label="anchor" href="#tutorial"></a>
</h2>
<p>This document outlines a step-by-step workflow for analyzing compositional dissimilarity and bioregionalization using <strong>dissMapR</strong>.<br>
All code chunks below illustrate how one might implement each step in R, using various commonly used packages (e.g., <code>sf</code>, <code>terra</code>, <code>dplyr</code>, <code>ggplot2</code>, etc.).<br>
Please note that paths to data, package names, or exact functions may need adjustment depending on your local setup.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># library(dissMapR)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/yourname/templateB3" class="external-link">templateB3</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># setwd('D:\\Methods\\R\\myR_Packages\\templateB3')</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="id_1-user-defined-area-of-interest-and-grid-resolution">1. User-Defined Area of Interest and Grid Resolution<a class="anchor" aria-label="anchor" href="#id_1-user-defined-area-of-interest-and-grid-resolution"></a>
</h2>
<div class="section level4">
<h4 id="load-libraries">Load libraries<a class="anchor" aria-label="anchor" href="#load-libraries"></a>
</h4>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load necessary libraries</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span>      <span class="co"># for vector spatial data</span></span>
<span><span class="co">#&gt; Linking to GEOS 3.13.0, GDAL 3.10.1, PROJ 9.5.1; sf_use_s2() is TRUE</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span>   <span class="co"># for raster/grid operations</span></span>
<span><span class="co">#&gt; terra 1.8.29</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>   <span class="co"># for data manipulation</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:terra':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, union</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span> <span class="co"># for plotting</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'tidyr'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:terra':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     extract</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'data.table'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:dplyr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     between, first, last</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:terra':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     shift</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://httr.r-lib.org/" class="external-link">httr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">geodata</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://zoo.R-Forge.R-project.org/" class="external-link">zoo</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'zoo'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:data.table':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     yearmon, yearqtr</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:terra':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     time&lt;-</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     as.Date, as.Date.numeric</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="define-the-aoi-eg-using-a-shapefile-rsashp">Define the AOI (e.g., using a shapefile â€˜rsa.shpâ€™)<a class="anchor" aria-label="anchor" href="#define-the-aoi-eg-using-a-shapefile-rsashp"></a>
</h4>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Adjust the path and layer name as needed</span></span>
<span><span class="co"># aoi &lt;- st_read("D:/Methods/R/myR_Packages/all_B3_packages/dissMapR/data/rsa.shp")</span></span>
<span><span class="co"># aoi &lt;- st_read(system.file("data", "rsa.shp", package = "dissMapR"))</span></span>
<span><span class="va">aoi</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="st">"D:/Methods/R/myR_Packages/templateB3/inst/extdata/rsa.shp"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Reading layer `rsa' from data source </span></span>
<span><span class="co">#&gt;   `D:\Methods\R\myR_Packages\templateB3\inst\extdata\rsa.shp' </span></span>
<span><span class="co">#&gt;   using driver `ESRI Shapefile'</span></span>
<span><span class="co">#&gt; Simple feature collection with 1 feature and 1 field</span></span>
<span><span class="co">#&gt; Geometry type: POLYGON</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 16.45802 ymin: -34.83514 xmax: 32.89125 ymax: -22.12661</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co"># aoi &lt;- st_read(system.file("extdata", "rsa.shp", package = "dissMapR"))</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="generate-grid-and-centroids-data-frame">Generate Grid and Centroids Data Frame<a class="anchor" aria-label="anchor" href="#generate-grid-and-centroids-data-frame"></a>
</h4>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#### Grid Resolution (e.g., 0.5 degrees)</span></span>
<span><span class="va">grid_res</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span></span>
<span><span class="co"># Create blank raster template with grid_res over the AOI</span></span>
<span><span class="co"># Use terra::rast() and the extent (bounding box) from 'aoi'</span></span>
<span><span class="va">r_template</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/ext.html" class="external-link">ext</a></span><span class="op">(</span><span class="va">aoi</span><span class="op">)</span>, resolution <span class="op">=</span> <span class="va">grid_res</span>, crs <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="va">aoi</span><span class="op">)</span><span class="op">$</span><span class="va">wkt</span><span class="op">)</span></span>
<span><span class="va">r_template</span></span>
<span><span class="co">#&gt; class       : SpatRaster </span></span>
<span><span class="co">#&gt; dimensions  : 25, 33, 1  (nrow, ncol, nlyr)</span></span>
<span><span class="co">#&gt; resolution  : 0.4979767, 0.5083412  (x, y)</span></span>
<span><span class="co">#&gt; extent      : 16.45802, 32.89125, -34.83514, -22.12661  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; coord. ref. : lon/lat WGS 84 (EPSG:4326)</span></span>
<span></span>
<span><span class="co"># Convert raster cell centroids to a data frame (x = longitude, y = latitude)</span></span>
<span><span class="va">xy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/crds.html" class="external-link">crds</a></span><span class="op">(</span><span class="va">r_template</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">xy</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">xy</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 825   2</span></span>
<span></span>
<span><span class="co"># Optional: clip out grid cells that fall outside the AOI boundary</span></span>
<span><span class="co"># Convert xy -&gt; sf -&gt; spatial filter</span></span>
<span><span class="va">xy_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="va">xy</span>, coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span>, crs <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="va">aoi</span><span class="op">)</span>, remove <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">xy_aoi</span> <span class="op">&lt;-</span> <span class="va">xy_sf</span><span class="op">[</span><span class="va">aoi</span>, <span class="op">]</span>  <span class="co"># intersection</span></span>
<span><span class="va">xy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_drop_geometry</a></span><span class="op">(</span><span class="va">xy_aoi</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">xy</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 465   2</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="visualise-aoi-grid-on-map">Visualise AOI Grid on Map<a class="anchor" aria-label="anchor" href="#visualise-aoi-grid-on-map"></a>
</h4>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Quick visualization: AOI + centroid points</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_sf</span><span class="op">(</span>data <span class="op">=</span> <span class="va">aoi</span>, fill <span class="op">=</span> <span class="st">"lightgray"</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>data <span class="op">=</span> <span class="va">xy</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"blue"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Area of Interest with 0.5Â° Grid"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-map_aoi-1.png" width="100%"></p>
<p><strong>Outcome</strong>:<br>
- A map of the AOI with 0.5Â° grid cells<br>
- A data frame <code>xy</code> containing centroid coordinates for each site (grid cell)</p>
</div>
</div>
<div class="section level2">
<h2 id="id_2-site-by-species-matrix-and-sampling-effort">2. Site-by-Species Matrix and Sampling Effort<a class="anchor" aria-label="anchor" href="#id_2-site-by-species-matrix-and-sampling-effort"></a>
</h2>
<div class="section level4">
<h4 id="occurrence_data">Occurrence_Data<a class="anchor" aria-label="anchor" href="#occurrence_data"></a>
</h4>
<p>Suppose you have occurrence data with fields: species, longitude, latitude (e.g., from GBIF, local CSV, etc.).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate for demonstration</span></span>
<span><span class="va">occ_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SpeciesA"</span>, <span class="st">"SpeciesB"</span>, <span class="st">"SpeciesC"</span><span class="op">)</span>, <span class="fl">1000</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html" class="external-link">st_bbox</a></span><span class="op">(</span><span class="va">aoi</span><span class="op">)</span><span class="op">[</span><span class="st">"xmin"</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html" class="external-link">st_bbox</a></span><span class="op">(</span><span class="va">aoi</span><span class="op">)</span><span class="op">[</span><span class="st">"xmax"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  y  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html" class="external-link">st_bbox</a></span><span class="op">(</span><span class="va">aoi</span><span class="op">)</span><span class="op">[</span><span class="st">"ymin"</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html" class="external-link">st_bbox</a></span><span class="op">(</span><span class="va">aoi</span><span class="op">)</span><span class="op">[</span><span class="st">"ymax"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Assign each record to a grid cell based on coordinates:</span></span>
<span><span class="co"># Convert 'xy' to a raster to facilitate cell lookups</span></span>
<span><span class="va">r_id</span> <span class="op">&lt;-</span> <span class="va">r_template</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">r_id</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">ncell</a></span><span class="op">(</span><span class="va">r_id</span><span class="op">)</span>  <span class="co"># each cell gets a unique ID</span></span>
<span></span>
<span><span class="co"># Convert occurrence data to SpatVector (terra) for cell lookups</span></span>
<span><span class="va">occ_vect</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/vect.html" class="external-link">vect</a></span><span class="op">(</span><span class="va">occ_data</span>, geom <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span>, crs <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/crs.html" class="external-link">crs</a></span><span class="op">(</span><span class="va">r_template</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Identify cell ID for each occurrence</span></span>
<span><span class="va">cell_ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/xyCellFrom.html" class="external-link">cellFromXY</a></span><span class="op">(</span><span class="va">r_id</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/geometry.html" class="external-link">geom</a></span><span class="op">(</span><span class="va">occ_vect</span><span class="op">)</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">occ_data</span><span class="op">$</span><span class="va">cell_id</span> <span class="op">&lt;-</span> <span class="va">cell_ids</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">occ_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1000    4</span></span>
<span></span>
<span><span class="co"># Filter out occurrences that fall outside the defined AOI grid</span></span>
<span><span class="va">occ_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">occ_data</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">cell_id</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">occ_data</span><span class="op">)</span></span>
<span><span class="co">#&gt;    species        x         y cell_id</span></span>
<span><span class="co">#&gt; 1 SpeciesA 21.31359 -24.14628     109</span></span>
<span><span class="co">#&gt; 2 SpeciesA 27.62681 -34.56023     815</span></span>
<span><span class="co">#&gt; 3 SpeciesB 19.05475 -23.78736     105</span></span>
<span><span class="co">#&gt; 4 SpeciesC 28.13970 -24.33725     156</span></span>
<span><span class="co">#&gt; 5 SpeciesA 22.90552 -32.16872     640</span></span>
<span><span class="co">#&gt; 6 SpeciesC 25.08964 -29.07542     447</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">occ_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1000    4</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="unique-site-codes-with-coordinates">Unique site codes with coordinates<a class="anchor" aria-label="anchor" href="#unique-site-codes-with-coordinates"></a>
</h4>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Site coordinates</span></span>
<span><span class="co"># Count number of occurrences per cell as a measure of sampling effort</span></span>
<span><span class="va">sites_xy</span> <span class="op">&lt;-</span> <span class="va">occ_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">cell_id</span>, <span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>effort <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>            richness <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/n_distinct.html" class="external-link">n_distinct</a></span><span class="op">(</span><span class="va">species</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; `summarise()` has grouped output by 'cell_id', 'x'. You can override using the</span></span>
<span><span class="co">#&gt; `.groups` argument.</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">sites_xy</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cell_id"</span>,<span class="st">"x"</span>,<span class="st">"y"</span>,<span class="st">"effort"</span>,<span class="st">"richness"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">sites_xy</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1000    5</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sites_xy</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 Ã— 5</span></span>
<span><span class="co">#&gt; # Groups:   cell_id, x [6]</span></span>
<span><span class="co">#&gt;   cell_id     x     y effort richness</span></span>
<span><span class="co">#&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;int&gt;    &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1       3  17.6 -22.3      1        1</span></span>
<span><span class="co">#&gt; 2       3  17.9 -22.4      1        1</span></span>
<span><span class="co">#&gt; 3       3  17.9 -22.2      1        1</span></span>
<span><span class="co">#&gt; 4       4  18.0 -22.4      1        1</span></span>
<span><span class="co">#&gt; 5       4  18.1 -22.4      1        1</span></span>
<span><span class="co">#&gt; 6       5  18.7 -22.5      1        1</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="sampling-effort">Sampling Effort<a class="anchor" aria-label="anchor" href="#sampling-effort"></a>
</h4>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Count number of occurrences per cell as a measure of sampling effort</span></span>
<span><span class="va">effort_df</span> <span class="op">&lt;-</span> <span class="va">occ_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">cell_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># ,decimalLongitude,decimalLatitude</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>n_occurrences <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">effort_df</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 595   2</span></span>
<span></span>
<span><span class="co"># Rasterize sampling effort (optional for mapping)</span></span>
<span><span class="va">sam_eff_rast</span> <span class="op">&lt;-</span> <span class="va">r_id</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">sam_eff_rast</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">sam_eff_rast</span><span class="op">)</span><span class="op">[</span><span class="va">effort_df</span><span class="op">$</span><span class="va">cell_id</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">effort_df</span><span class="op">$</span><span class="va">n_occurrences</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="site-by-species-matrix">Site by Species Matrix<a class="anchor" aria-label="anchor" href="#site-by-species-matrix"></a>
</h4>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For presence-absence, pivot occurrence data to wide format:</span></span>
<span><span class="co"># occ_data = c('species', 'x', 'y', 'cell_id')</span></span>
<span><span class="va">sbs_long</span> <span class="op">&lt;-</span> <span class="va">occ_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="va">cell_id</span>, <span class="va">species</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>presence <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">sbs_long</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 820   3</span></span>
<span></span>
<span><span class="co"># Ensure we have a row for every cell (site) in 'xy'</span></span>
<span><span class="va">all_cells</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>cell_id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">ncell</a></span><span class="op">(</span><span class="va">r_id</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sbs_wide</span> <span class="op">&lt;-</span> <span class="va">all_cells</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">sbs_long</span>, by <span class="op">=</span> <span class="st">"cell_id"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>id_cols <span class="op">=</span> <span class="va">cell_id</span>, names_from <span class="op">=</span> <span class="va">species</span>, values_from <span class="op">=</span> <span class="va">presence</span>, values_fill <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">sbs_wide</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 825   5</span></span>
<span></span>
<span><span class="co"># sbs - site-by-species matrix</span></span>
<span><span class="va">sbs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">sbs_wide</span><span class="op">[</span> , <span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>  <span class="co"># remove cell_id column</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names</a></span><span class="op">(</span><span class="va">sbs</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">sbs_wide</span><span class="op">$</span><span class="va">cell_id</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">sbs</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 825   4</span></span>
<span></span>
<span><span class="co"># Summarize sampling effort in a vector aligned with sbs rows</span></span>
<span><span class="va">sam.eff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sbs</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sam.eff</span><span class="op">[</span><span class="va">effort_df</span><span class="op">$</span><span class="va">cell_id</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">effort_df</span><span class="op">$</span><span class="va">n_occurrences</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="optional-richness-and-sampling-effort-maps">Optional Richness and Sampling Effort Maps<a class="anchor" aria-label="anchor" href="#optional-richness-and-sampling-effort-maps"></a>
</h4>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Species richness map (row sums of sbs)</span></span>
<span><span class="va">richness</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/rowSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">sbs</span><span class="op">)</span></span>
<span><span class="va">richness_rast</span> <span class="op">&lt;-</span> <span class="va">r_id</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">richness_rast</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">richness_rast</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">richness</span><span class="op">)</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">richness</span></span>
<span></span>
<span><span class="co"># Quick plot of sampling effort + species richness</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sam_eff_rast</span>, main <span class="op">=</span> <span class="st">"Sampling Effort"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-map_rich-1.png" width="100%"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">richness_rast</span>, main <span class="op">=</span> <span class="st">"Species Richness"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-map_rich-2.png" width="100%"></p>
<p><strong>Outcome</strong>:<br>
- <strong>sbs</strong>: binary presenceâ€“absence (site-by-species)<br>
- <strong>sam.eff</strong>: numeric sampling effort per site<br>
- Optional raster maps for sampling effort and species richness</p>
</div>
</div>
<div class="section level2">
<h2 id="id_3-site-by-environment-matrix">3. Site-by-Environment Matrix<a class="anchor" aria-label="anchor" href="#id_3-site-by-environment-matrix"></a>
</h2>
<div class="section level4">
<h4 id="environmental-data">Environmental Data<a class="anchor" aria-label="anchor" href="#environmental-data"></a>
</h4>
<p>Assume we have environmental rasters (temp, precip, etc.) with same CRS and extent</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Here we just simulate them:</span></span>
<span><span class="va">env1</span> <span class="op">&lt;-</span> <span class="va">r_template</span>; <span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">env1</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">ncell</a></span><span class="op">(</span><span class="va">r_template</span><span class="op">)</span>, min <span class="op">=</span> <span class="fl">10</span>, max <span class="op">=</span> <span class="fl">30</span><span class="op">)</span>  <span class="co"># e.g., temperature</span></span>
<span><span class="va">env2</span> <span class="op">&lt;-</span> <span class="va">r_template</span>; <span class="fu"><a href="https://rspatial.github.io/terra/reference/values.html" class="external-link">values</a></span><span class="op">(</span><span class="va">env2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">ncell</a></span><span class="op">(</span><span class="va">r_template</span><span class="op">)</span>, min <span class="op">=</span> <span class="fl">100</span>, max <span class="op">=</span> <span class="fl">3000</span><span class="op">)</span> <span class="co"># e.g., precipitation</span></span>
<span></span>
<span><span class="co"># Combine into a SpatRaster</span></span>
<span><span class="va">env_stack</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">env1</span>, <span class="va">env2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">env_stack</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"temp"</span>, <span class="st">"precip"</span><span class="op">)</span></span>
<span><span class="va">env_stack</span></span>
<span><span class="co">#&gt; class       : SpatRaster </span></span>
<span><span class="co">#&gt; dimensions  : 25, 33, 2  (nrow, ncol, nlyr)</span></span>
<span><span class="co">#&gt; resolution  : 0.4979767, 0.5083412  (x, y)</span></span>
<span><span class="co">#&gt; extent      : 16.45802, 32.89125, -34.83514, -22.12661  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; coord. ref. : lon/lat WGS 84 (EPSG:4326) </span></span>
<span><span class="co">#&gt; source(s)   : memory</span></span>
<span><span class="co">#&gt; names       :     temp,    precip </span></span>
<span><span class="co">#&gt; min values  : 10.02008,  102.5856 </span></span>
<span><span class="co">#&gt; max values  : 29.97091, 2999.7811</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="extract-environmental-values">Extract Environmental Values<a class="anchor" aria-label="anchor" href="#extract-environmental-values"></a>
</h4>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract environmental values at each site centroid</span></span>
<span><span class="va">env_vals</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/extract.html" class="external-link">extract</a></span><span class="op">(</span><span class="va">env_stack</span>, <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">sites_xy</span><span class="op">$</span><span class="va">x</span>, <span class="va">sites_xy</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">env_vals</span><span class="op">)</span></span>
<span><span class="co">#&gt;       temp    precip</span></span>
<span><span class="co">#&gt; 1 10.42225 1892.7073</span></span>
<span><span class="co">#&gt; 2 10.42225 1892.7073</span></span>
<span><span class="co">#&gt; 3 10.42225 1892.7073</span></span>
<span><span class="co">#&gt; 4 22.49751 1798.8709</span></span>
<span><span class="co">#&gt; 5 22.49751 1798.8709</span></span>
<span><span class="co">#&gt; 6 25.87650  561.6971</span></span>
<span><span class="co"># env_vals &lt;- env_vals[ , -1]  # remove ID column returned by extract()</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="build-sbe">Build SBE<a class="anchor" aria-label="anchor" href="#build-sbe"></a>
</h4>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Combine environment variables + sampling effort into one data frame</span></span>
<span><span class="va">sbe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">env_vals</span>, <span class="va">sites_xy</span><span class="op">$</span><span class="va">effort</span><span class="op">)</span>  <span class="co"># site-by-environment, includes sampling effort</span></span>
<span><span class="co"># env_vals &lt;- cbind(sites_xy[, c(1,4,5)], env_vals)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">sbe</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1000    3</span></span>
<span><span class="co"># colnames(sbe) &lt;- c("temp", "precip", "sam.eff")</span></span>
<span></span>
<span><span class="co"># We'll also update the env_stack to include sampling effort if desired</span></span>
<span><span class="va">sam_eff_raster</span> <span class="op">&lt;-</span> <span class="va">sam_eff_rast</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">sam_eff_raster</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"sam.eff"</span></span>
<span><span class="va">env_stack_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">env_stack</span>, <span class="va">sam_eff_raster</span><span class="op">)</span></span>
<span><span class="va">env_stack_all</span></span>
<span><span class="co">#&gt; class       : SpatRaster </span></span>
<span><span class="co">#&gt; dimensions  : 25, 33, 3  (nrow, ncol, nlyr)</span></span>
<span><span class="co">#&gt; resolution  : 0.4979767, 0.5083412  (x, y)</span></span>
<span><span class="co">#&gt; extent      : 16.45802, 32.89125, -34.83514, -22.12661  (xmin, xmax, ymin, ymax)</span></span>
<span><span class="co">#&gt; coord. ref. : lon/lat WGS 84 (EPSG:4326) </span></span>
<span><span class="co">#&gt; source(s)   : memory</span></span>
<span><span class="co">#&gt; names       :     temp,    precip, sam.eff </span></span>
<span><span class="co">#&gt; min values  : 10.02008,  102.5856,       0 </span></span>
<span><span class="co">#&gt; max values  : 29.97091, 2999.7811,       5</span></span></code></pre></div>
<p><strong>Outcome</strong>:<br>
- <strong>sbe</strong>: site-by-environment matrix (including sampling effort)<br>
- Updated raster stack (<code>env_stack_all</code>) with environment layers + sampling effort</p>
</div>
</div>
<div class="section level2">
<h2 id="id_4-zeta-decline-and-zeta-decay">4. Zeta Decline and Zeta Decay<a class="anchor" aria-label="anchor" href="#id_4-zeta-decline-and-zeta-decay"></a>
</h2>
<div class="section level4">
<h4 id="zeta-decline">Zeta Decline<a class="anchor" aria-label="anchor" href="#zeta-decline"></a>
</h4>
<p>Weâ€™ll assume dissMapR or zetadiv provides functions for multi-site zeta.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For example, using the 'zetadiv' package:</span></span>
<span><span class="co"># library(zetadiv)</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># # sbs must be a site-by-species matrix (rows=sites, columns=species)</span></span>
<span><span class="co"># zeta_orders &lt;- 1:5</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># # Run `Zeta.decline.ex`</span></span>
<span><span class="co"># zeta.decline &lt;- Zeta.decline.ex(sbs[,-3],</span></span>
<span><span class="co">#                                 orders = zeta_orders,</span></span>
<span><span class="co">#                                 plot = FALSE)</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># # Plot zeta decline</span></span>
<span><span class="co"># plot(zeta_orders,</span></span>
<span><span class="co">#      zeta.decline$zeta.val,</span></span>
<span><span class="co">#      type = "b",</span></span>
<span><span class="co">#      xlab = "Order", ylab = "Mean Zeta Diversity",</span></span>
<span><span class="co">#      main = "Zeta Decline")</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="zeta-decay">Zeta Decay<a class="anchor" aria-label="anchor" href="#zeta-decay"></a>
</h4>
<p>Evaluate how zeta diversity changes with distance</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">sbs</span><span class="op">[</span>,<span class="op">-</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 825   3</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">sites_xy</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1000    5</span></span>
<span></span>
<span><span class="co"># zeta.decay &lt;- Zeta.ddecay(</span></span>
<span><span class="co">#   data.spec   = sbs[,-3],          # species presence-absence matrix</span></span>
<span><span class="co">#   # xy          = cbind(xy_sf$x,xy_sf$y),# site coordinates</span></span>
<span><span class="co">#   xy          = cbind(sites_xy$x,sites_xy$y),# site coordinates</span></span>
<span><span class="co">#   order       = 2,            # zeta order of interest (e.g., 2)</span></span>
<span><span class="co">#   method      = "mean",       # or "sum"</span></span>
<span><span class="co">#   sam         = 100,           # number of distance bins (or set distances manually)</span></span>
<span><span class="co">#   plot        = FALSE         # set to TRUE to auto-plot</span></span>
<span><span class="co"># )</span></span>
<span></span>
<span><span class="co"># The returned object contains distance bins (or pairs of sites, etc.) and</span></span>
<span><span class="co"># average zeta diversity for each distance bin.</span></span>
<span></span>
<span><span class="co"># Plot the result:</span></span>
<span><span class="co"># Plot.zeta.ddecay(zeta.decay)</span></span>
<span></span>
<span><span class="co"># Multiple-Order Distance Decay Example</span></span>
<span><span class="co"># If you want to see how zeta distance-decay behaves across multiple orders,</span></span>
<span><span class="co"># you can use Zeta.ddecays():</span></span>
<span></span>
<span><span class="co"># zeta.decays &lt;- Zeta.ddecays(</span></span>
<span><span class="co">#   data.spec   = sbs[,-3],</span></span>
<span><span class="co">#   xy          = cbind(sites_xy$x,sites_xy$y),</span></span>
<span><span class="co">#   orders      = zeta_orders,       # or pick any vector of orders</span></span>
<span><span class="co">#   method      = "mean",</span></span>
<span><span class="co">#   sam         = 1000,</span></span>
<span><span class="co">#   plot        = FALSE</span></span>
<span><span class="co"># )</span></span>
<span></span>
<span><span class="co"># Then visualize:</span></span>
<span><span class="co"># Plot.zeta.ddecays(zeta.decays)</span></span></code></pre></div>
<p><strong>Outcome</strong>:<br>
- Measures of <strong>zeta decline</strong> across orders<br>
- Measures of <strong>zeta decay</strong> with distance<br>
- Plots illustrating these relationships</p>
</div>
</div>
<div class="section level2">
<h2 id="id_5-ms-gdm-with-zetamsgdmsbs-sbe-xy">5. MS-GDM with <code>Zeta.msgdm(sbs, sbe, xy)</code>
<a class="anchor" aria-label="anchor" href="#id_5-ms-gdm-with-zetamsgdmsbs-sbe-xy"></a>
</h2>
<div class="section level4">
<h4 id="fit-multisite-gdm">Fit MultiSite GDM<a class="anchor" aria-label="anchor" href="#fit-multisite-gdm"></a>
</h4>
<p>We now assume dissMapR has a function Zeta.msgdm() for multi-site GDM (this is hypothetical; adapt based on actual package usage)</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit MS-GDM for orders = 2, 3, 5, 10</span></span>
<span><span class="va">orders_to_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">sbs</span><span class="op">[</span>,<span class="op">-</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 825   3</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">sbe</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1000    3</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">sites_xy</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1000    5</span></span>
<span><span class="co"># fit &lt;- Zeta.msgdm(sbs[,-3],</span></span>
<span><span class="co">#                   sbe,</span></span>
<span><span class="co">#                   sites_xy[,2:3],</span></span>
<span><span class="co">#                   order = orders_to_fit,</span></span>
<span><span class="co">#                   reg.type = 'ispline',</span></span>
<span><span class="co">#                   sam = 100)</span></span>
<span></span>
<span><span class="co"># Summaries or model stats</span></span>
<span><span class="co"># summary(fit$model)</span></span>
<span></span>
<span><span class="co"># dev.new()</span></span>
<span><span class="co"># graphics::plot(fit$model)</span></span></code></pre></div>
<p><strong>Outcome</strong>:<br>
- <strong>zeta2</strong>: fitted MS-GDM for order 2<br>
- Additional model objects for orders 3, 5, and 10</p>
</div>
</div>
<div class="section level2">
<h2 id="id_6-prediction-with-zeta2-present-scenario">6. Prediction with <code>zeta2</code> (Present Scenario)<a class="anchor" aria-label="anchor" href="#id_6-prediction-with-zeta2-present-scenario"></a>
</h2>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># # Uniform Sampling</span></span>
<span><span class="co"># # Replace sampling effort in 'sbe' with its maximum value</span></span>
<span><span class="co"># sam.max &lt;- max(sbe$sam.eff)</span></span>
<span><span class="co"># sbe_now &lt;- sbe</span></span>
<span><span class="co"># sbe_now$sam.eff &lt;- sam.max</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># # Predict zeta2</span></span>
<span><span class="co"># zeta.now &lt;- predict(zeta2, newdata = sbe_now)</span></span>
<span><span class="co"># # zeta.now should be a site-by-site matrix of predicted dissimilarities (order=2)</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># # Visualize zeta_now</span></span>
<span><span class="co"># # (i) NMDS</span></span>
<span><span class="co"># library(vegan)</span></span>
<span><span class="co"># nmds_now &lt;- metaMDS(zeta.now, k = 3, try = 20)</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># # Extract NMDS coordinates</span></span>
<span><span class="co"># nmds_coords &lt;- as.data.frame(scores(nmds_now))</span></span>
<span><span class="co"># colnames(nmds_coords) &lt;- c("NMDS1", "NMDS2", "NMDS3")</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># # (ii) RGB composite plot from NMDS axes</span></span>
<span><span class="co"># # Combine NMDS coords with site centroids 'xy'</span></span>
<span><span class="co"># nmds_plot_df &lt;- cbind(xy, nmds_coords)</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># ggplot(nmds_plot_df, aes(x = x, y = y)) +</span></span>
<span><span class="co">#   geom_point(aes(color = rgb(</span></span>
<span><span class="co">#     scales::rescale(NMDS1),</span></span>
<span><span class="co">#     scales::rescale(NMDS2),</span></span>
<span><span class="co">#     scales::rescale(NMDS3)</span></span>
<span><span class="co">#   )), size = 2) +</span></span>
<span><span class="co">#   scale_color_identity() +</span></span>
<span><span class="co">#   ggtitle("Present Scenario: NMDS RGB Composite") +</span></span>
<span><span class="co">#   theme_minimal()</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># # (iii) Clustering + Bioregions</span></span>
<span><span class="co"># # Example: hierarchical clustering</span></span>
<span><span class="co"># hc_now &lt;- hclust(as.dist(zeta.now), method = "ward.D2")</span></span>
<span><span class="co"># # Choose number of clusters</span></span>
<span><span class="co"># k &lt;- 5</span></span>
<span><span class="co"># bioregions_now &lt;- cutree(hc_now, k = k)</span></span></code></pre></div>
<p><strong>Outcome</strong>:<br>
- <strong>zeta.now</strong>: predicted site-by-site dissimilarity matrix under uniform sampling<br>
- NMDS-based RGB map<br>
- Bioregional clusters (e.g., 5 clusters)</p>
</div>
<div class="section level2">
<h2 id="id_7-prediction-with-zeta2-future-scenarios">7. Prediction with <code>zeta2</code> (Future Scenarios)<a class="anchor" aria-label="anchor" href="#id_7-prediction-with-zeta2-future-scenarios"></a>
</h2>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Prepare Future Env</span></span>
<span><span class="co"># # Suppose we have m future scenarios for environment (temp, precip).</span></span>
<span><span class="co"># # We'll combine them so that all scenarios + present are in one large sbe data frame.</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># # Create a placeholder example for 2 future scenarios</span></span>
<span><span class="co"># env1_future1 &lt;- env1; values(env1_future1) &lt;- values(env1_future1) + 2</span></span>
<span><span class="co"># env2_future1 &lt;- env2; values(env2_future1) &lt;- values(env2_future1) + 100</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># env1_future2 &lt;- env1; values(env1_future2) &lt;- values(env1_future2) + 4</span></span>
<span><span class="co"># env2_future2 &lt;- env2; values(env2_future2) &lt;- values(env2_future2) + 200</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># # Extract for each scenario</span></span>
<span><span class="co"># env_vals_future1 &lt;- extract(c(env1_future1, env2_future1), cbind(xy$x, xy$y))[, -1]</span></span>
<span><span class="co"># env_vals_future2 &lt;- extract(c(env1_future2, env2_future2), cbind(xy$x, xy$y))[, -1]</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># # Combine into data frames, reusing sam.max</span></span>
<span><span class="co"># sbe_future1 &lt;- cbind(env_vals_future1, sam.eff = sam.max)</span></span>
<span><span class="co"># colnames(sbe_future1) &lt;- c("temp", "precip", "sam.eff")</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># sbe_future2 &lt;- cbind(env_vals_future2, sam.eff = sam.max)</span></span>
<span><span class="co"># colnames(sbe_future2) &lt;- c("temp", "precip", "sam.eff")</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># # Combine present (sbe_now) + 2 future scenarios:</span></span>
<span><span class="co"># sbe_all &lt;- rbind(sbe_now, sbe_future1, sbe_future2)</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># # Predict Future</span></span>
<span><span class="co"># zeta.future &lt;- predict(zeta2, newdata = sbe_all)</span></span>
<span><span class="co"># # This will be a ((m+1)*n x (m+1)*n) dissimilarity matrix</span></span>
<span><span class="co"># # where m=2 (two future scenarios), n=number of sites</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># # Visualize Future</span></span>
<span><span class="co"># # We can subset 'zeta.future' to map each scenario individually</span></span>
<span><span class="co"># # For example, the first 'n' rows/cols = present, next 'n' = future1, last 'n' = future2</span></span>
<span><span class="co"># n_sites &lt;- nrow(sbe_now)</span></span>
<span><span class="co"># present_idx   &lt;- 1:n_sites</span></span>
<span><span class="co"># future1_idx   &lt;- (n_sites+1):(2*n_sites)</span></span>
<span><span class="co"># future2_idx   &lt;- (2*n_sites+1):(3*n_sites)</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># zeta.present  &lt;- zeta.future[present_idx, present_idx]</span></span>
<span><span class="co"># zeta.fut1     &lt;- zeta.future[future1_idx, future1_idx]</span></span>
<span><span class="co"># zeta.fut2     &lt;- zeta.future[future2_idx, future2_idx]</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># # Optionally run NMDS or clustering for each scenario</span></span>
<span><span class="co"># # Here, just an example with future scenario 1</span></span>
<span><span class="co"># nmds_fut1 &lt;- metaMDS(zeta.fut1, k = 3, try = 20)</span></span>
<span><span class="co"># nmds_coords_fut1 &lt;- as.data.frame(scores(nmds_fut1))</span></span>
<span><span class="co"># # (Plot similarly as above, but note the site order matches rows in future1_idx)</span></span></code></pre></div>
<p><strong>Outcome</strong>:<br>
- <strong>zeta.future</strong>: site-by-site predicted dissimilarities for present + multiple future scenarios<br>
- Tools for NMDS/clustering to map future shifts in bioregions</p>
</div>
<div class="section level2">
<h2 id="id_8-data-publication-to-zenodo">8. Data Publication to Zenodo<a class="anchor" aria-label="anchor" href="#id_8-data-publication-to-zenodo"></a>
</h2>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Prepare Outputs</span></span>
<span><span class="co"># Collect your final data frames and raster objects:</span></span>
<span><span class="co">#   - sbs, xy, sbe, zeta.now, zeta.future, etc.</span></span>
<span><span class="co">#   - Maps (sampling effort, zeta plots, NMDS RGB maps, cluster results)</span></span>
<span><span class="co">#   - Model objects (zeta2, etc.)</span></span>
<span></span>
<span><span class="co"># # Save them to disk as CSV, RDS, GeoTIFF, etc.</span></span>
<span><span class="co"># saveRDS(sbs, "sbs.rds")</span></span>
<span><span class="co"># saveRDS(xy, "xy.rds")</span></span>
<span><span class="co"># saveRDS(sbe, "sbe.rds")</span></span>
<span><span class="co"># saveRDS(zeta.now, "zeta_now.rds")</span></span>
<span><span class="co"># saveRDS(zeta.future, "zeta_future.rds")</span></span>
<span><span class="co"># # ... etc.</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># # Zenodo Upload</span></span>
<span><span class="co"># # Use zen4R or manual upload:</span></span>
<span><span class="co"># # install.packages("zen4R")</span></span>
<span><span class="co"># library(zen4R)</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># # Provide your Zenodo token, metadata, etc.</span></span>
<span><span class="co"># zenodo &lt;- ZenodoManager$new(token = "YOUR_ZENODO_TOKEN")</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># # Create a new deposition, set metadata</span></span>
<span><span class="co"># my_deposition &lt;- zenodo$createEmptyRecord()</span></span>
<span><span class="co"># my_deposition &lt;- zenodo$setMetadata(</span></span>
<span><span class="co">#   my_deposition,</span></span>
<span><span class="co">#   title = "Multi-Site Dissimilarity Data &amp; Models",</span></span>
<span><span class="co">#   upload_type = "dataset",</span></span>
<span><span class="co">#   description = "Data and model outputs from the dissMapR workflow.",</span></span>
<span><span class="co">#   creators = list(</span></span>
<span><span class="co">#     list(name = "Your Name", affiliation = "Your Institution")</span></span>
<span><span class="co">#   )</span></span>
<span><span class="co"># )</span></span>
<span></span>
<span><span class="co"># Then upload files:</span></span>
<span><span class="co"># zenodo$uploadFile("sbs.rds", my_deposition$id)</span></span>
<span><span class="co"># zenodo$uploadFile("sbe.rds", my_deposition$id)</span></span>
<span><span class="co"># etc.</span></span>
<span></span>
<span><span class="co"># Finally, publish:</span></span>
<span><span class="co"># zenodo$publishRecord(my_deposition$id)</span></span></code></pre></div>
<p><strong>Outcome</strong>:<br>
- All necessary data (e.g., <code>sbs</code>, <code>xy</code>, <code>sbe</code>, <code>zeta.now</code>, <code>zeta.future</code>, figures) are archived on Zenodo for reproducibility.</p>
<table class="table">
<colgroup><col width="100%"></colgroup>
<tbody>
<tr class="odd">
<td>## Final Remarks</td>
</tr>
<tr class="even">
<td>- This script demonstrates the <strong>core</strong> steps for dissecting compositional turnover and bioregional patterns under present or future scenarios using <code>dissMapR</code> (and related packages). - Each step can be adapted to use your specific data sources and packages. - Always verify spatial extents, coordinate reference systems, and the validity of environmental data before scaling up analyses.</td>
</tr>
</tbody>
</table>
<div class="section level3">
<h3 id="draft-notes-from-cangh">Draft notes from CangH:<a class="anchor" aria-label="anchor" href="#draft-notes-from-cangh"></a>
</h3>
<p>Dissimilarity workflow<br>
1. User-defined area of interest and grid resolution (incl.Â rsa shape file, 0.5 degree), generate a map of AOI and a data frame â€˜xyâ€™ of site centroids.<br>
2. Site by species matrix and sampling effort (incl.Â access occurrences of user-specified taxon or species list, assign records to the grids, generate a raster of occurrence counts called sampling effort), generate a binary data frame â€˜sbsâ€™, a richness map of sbs row sums, a single variable data frame of sampling effort â€˜sam.effâ€™ and its raster map. Note, occurrence coordinates are only used for assigning then into grids; they are not needed beyond this step.<br>
3. Site by environment matrix; extract environmental variables only for site centroids â€˜xyâ€™ and stack them into raster and data frame â€˜sbeâ€™; add â€˜sam.effâ€™ to the stack raster and sbe.<br>
4. Zeta decline (sbs) and zeta decay (sbs, xy), orders 2:15. Generate statistics and figures, no maps.<br>
5. Zeta.msgdm(sbs, sbe, xy), order 2, 3, 5, 10. Generate statistics and figures, no maps. Save fitted order 2 model â€˜zeta2â€™.<br>
6. Predict(zeta2) with â€˜sam.effâ€™ in the â€˜sbeâ€™ replaced by â€˜sam.maxâ€™ a constant for all sites = max(sam.eff). Predict for the updated sbe and xy and produce a site by site matrix of predicted zeta â€˜zeta.nowâ€™. Run nmds for the predicted zeta matrix and plot RGB of the 3 component scores. Clustering analyses directly using zeta.now. Generate main maps of dissimilarity (the rgb plot) and bioregions (from clustering).<br>
7. Predict(zeta2) with appended (future scenarios) environmental variables and â€˜sam.maxâ€™ in sbe. For m number of scenarios plus the present scenario (step6) and n sites of xy, this updated sbe.future will have k = (m+1) x n number of rows. â€˜xyâ€™ also updated with k rows. Predict a k by k matrix of predicted zeta â€˜zeta.futureâ€™. Nmds and clustering of zeta.future, map sub matrices to indicate predicted future dissimilarity, bioregions, and temporal turnover. Note, step6 is redundant if step7 is needed; step7 has the same code but more results including those from step6 but potentially computational demanding.<br>
8. Deposit all data frames, tables, maps, and standard metadata to zenodo</p>
</div>
</div>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/macSands/templateB3/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/macSands/templateB3/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing templateB3</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>The package maintainer <br><small class="roles"> Maintainer </small>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#stable" class="external-link"><img src="https://img.shields.io/badge/lifecycle-stable-brightgreen.svg" alt="Lifecycle: stable"></a></li>
<li><a href="https://github.com/macSands/templateB3/actions/workflows/test-coverage.yaml" class="external-link"><img src="https://github.com/macSands/templateB3/actions/workflows/test-coverage.yaml/badge.svg" alt="test-coverage"></a></li>
<li><a href="https://app.codecov.io/gh/macSands/templateB3" class="external-link"><img src="https://codecov.io/gh/macSands/templateB3/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://github.com/macSands/templateB3/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/macSands/templateB3/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by The package maintainer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
